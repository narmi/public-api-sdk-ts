# Getting started
1. Request `testuser` login credentials as well as OAuth application credentials from Narmi.
2. Download your target build from the (releases tag)[https://github.com/narmi/public-api-sdk-ts/tags]
   - Alternatively you can clone via `git clone git@github.com:narmi/public-api-sdk-ts.git` and then checkout the release version.
   - ex. `git checkout v2024.10.34`
3. `unzip` and `cd` into the project directory
```bash
$ unzip public-api-sdk-ts-<release_name>.zip
$ cd public-api-sdk-ts
```
4. Install [Node.js](https://nodejs.org/en/download/package-manager/current) v22.4.1. This should include `npm`, but if not also install npm@v10.8.2.
5. Create `.env` file in root directory and set values for OAuth and other configuration.
```ini
# paste the following variables into your .env file
CLIENT_ID=<oauth client id>
CLIENT_SECRET=<oauth client secret>
REDIRECT_URI=<url to redirect to during oauth2 flow>
AUTH_URL=<url to the oauth2 authentication endpoint>
API_URL=<url to the hosted api instance>
PORT=3000
```
6. Install dependencies  
```bash
npm install --include=dev
```
7. Build the test app
```bash
npm run build
```
8. Start the test app
```bash
npm start
```
9. Navigate to the test app login page http://localhost:3000/login and log in using the `testuser` account

You should now be able to see the running test app pull data from the Narmi Public API

# Understanding How it Works

The generated API creates a series of classes representing each *tag* of the documenation at https://online.sandbox.narmi.dev/v1/docs as an API. For instance, https://online.sandbox.narmi.dev/v1/docs#tag/accounts becomes: 

```typescript
import * as publicApiSDK from "../sdk/index";
let apiClass = publicApiSDK.AccountsApi
```

Each API must be provided with a configuration object when instantiated for authentication purposes. A utility has been defined at `public-api-sdk/src/utils.ts` to make this easier:

```typescript
let api = new publicApiSDK.AccountsApi(publicApiSDK.getConfiguration(access_token, header_secret))
```

Each API method is defined to represent an operation id from the documentation, so https://online.sandbox.narmi.dev/v1/docs#tag/accounts/operation/accounts_list becomes `accountsList`:

```typescript
let response = await api.accountsList()
```

Responses will be promises resolving to typed data structures, allowing typescript compatible linters to assist you with interacting with them. In the event of an error response, the SDK will throw an error instead of returning the unadultered response, so it's best to try/catch:
```typescript
  try {
    let response = await api.accountsRetrieve({"uuid": req.params.accountId})
    res.render("account", response)
  } catch(e) {
    utils.handleError(e, res)
  }
```

These examples are taken from `public-api-sdk/src/test-express-app/index.ts`, which powers the introductory application. 

## API Rubric
| Operation ID                            | SDK Verified | Schemathesis Verified | Notes/Considerations |
|-----------------------------------------|--------------|-----------------------|----------------------|
| account_balances_list                   | ğŸŸ¢           | ğŸŸ¢                    |                      |
| account_balances_retrieve               | ğŸŒ•           | ğŸŸ¢                    |                      |
| accounts_list                           | ğŸŸ¢           | ğŸŸ¢                    |                      |
| accounts_create                         | ğŸŒ•           | ğŸŒ•                    |                      |
| user_transactions_list                  | ğŸŒ•           | ğŸŒ•                    |                      |
| accounts_documents_retrieve             | ğŸŒ•           | ğŸŸ¢                    |                      |
| accounts_holds_list                     | ğŸŒ•           | ğŸŸ¢                    |                      |
| accounts_stops_list                     | ğŸŒ•           | ğŸŸ¢                    |                      |
| accounts_stops_create                   | ğŸŒ•           | ğŸŒ•                    |                      |
| accounts_transactions_download_retrieve | ğŸŒ•           | ğŸŸ¢                    |                      |
| accounts_retrieve                       | ğŸŸ¢           | ğŸŸ¢                    |                      |
| accounts_update                         | ğŸŒ•           | ğŸŒ•                    |                      |
| accounts_destroy                        | ğŸŒ•           | ğŸŒ•                    |                      |
| account_verify                          | ğŸŒ•           | ğŸŒ•                    |                      |
| accounts_withdrawals_create             | ğŸŒ•           | ğŸŒ•                    |                      |
| account_verify_instant                  | ğŸŒ•           | ğŸŒ•                    |                      |
| automatic_savings_enrollment_list       | ğŸŒ•           | ğŸŸ¢                    |                      |
| automatic_savings_enrollment_create     | ğŸŒ•           | ğŸŒ•                    |                      |
| automatic_savings_enrollment_destroy    | ğŸŒ•           | ğŸŒ•                    |                      |
| cards_list                              | ğŸŒ•           | ğŸŸ¢                    |                      |
| cards_retrieve                          | ğŸŒ•           | ğŸŒ•                    |                      |
| cards_update                            | ğŸŒ•           | ğŸŒ•                    |                      |
| cards_address_retrieve                  | ğŸŒ•           | ğŸŸ¢                    |                      |
| cards_lock_create                       | ğŸŒ•           | ğŸŒ•                    |                      |
| cards_replace_card_create               | ğŸŒ•           | ğŸŒ•                    |                      |
| cards_unlock_create                     | ğŸŒ•           | ğŸŒ•                    |                      |
| deposits_list                           | ğŸŒ•           | ğŸŸ¢                    |                      |
| deposits_create                         | ğŸŒ•           | ğŸŒ•                    |                      |
| deposits_retrieve                       | ğŸŒ•           | ğŸŸ¢                    |                      |
| documents_list                          | ğŸŒ•           | ğŸŸ¢                    |                      |
| documents_retrieve                      | ğŸŒ•           | ğŸŸ¢                    |                      |
| enroll_create                           | ğŸŒ•           | ğŸŒ•                    |                      |
| enroll_verify_create                    | ğŸŒ•           | ğŸŒ•                    |                      |
| enrollments_create                      | ğŸŒ•           | ğŸŒ•                    |                      |
| fedwire_templates_list                  | ğŸŒ•           | ğŸŸ¢                    |                      |
| fedwire_templates_create                | ğŸŒ•           | ğŸŒ•                    |                      |
| fedwire_templates_retrieve              | ğŸŒ•           | ğŸŸ¢                    |                      |
| fedwire_templates_update                | ğŸŒ•           | ğŸŒ•                    |                      |
| fedwire_templates_destroy               | ğŸŒ•           | ğŸŒ•                    |                      |
| institution_get                         | ğŸŒ•           | ğŸŸ¢                    |                      |
| institution_name_retrieve               | ğŸŒ•           | ğŸŸ¢                    |                      |
| me_list                                 | ğŸŒ•           | ğŸŸ¢                    |                      |
| mfa_list                                | ğŸŒ•           | ğŸŸ¢                    |                      |
| mfa_destroy                             | ğŸŒ•           | ğŸŒ•                    |                      |
| payees_list                             | ğŸŒ•           | ğŸŸ¢                    |                      |
| payees_create                           | ğŸŒ•           | ğŸŒ•                    |                      |
| payees_retrieve                         | ğŸŒ•           | ğŸŒ•                    |                      |
| payees_update                           | ğŸŒ•           | ğŸŒ•                    |                      |
| payees_destroy                          | ğŸŒ•           | ğŸŒ•                    |                      |
| payments_list                           | ğŸŒ•           | ğŸŸ¢                    |                      |
| payments_create                         | ğŸŒ•           | ğŸŒ•                    |                      |
| payments_destroy                        | ğŸŒ•           | ğŸŒ•                    |                      |
| ping_retrieve                           | ğŸŒ•           | ğŸŒ•                    |                      |
| subscriptions_list                      | ğŸŒ•           | ğŸŸ¢                    |                      |
| subscriptions_create                    | ğŸŒ•           | ğŸŒ•                    |                      |
| subscriptions_retrieve                  | ğŸŒ•           | ğŸŸ¢                    |                      |
| subscriptions_update                    | ğŸŒ•           | ğŸŒ•                    |                      |
| subscriptions_partial_update            | ğŸŒ•           | ğŸŒ•                    |                      |
| subscriptions_destroy                   | ğŸŒ•           | ğŸŒ•                    |                      |
| support_info_retrieve                   | ğŸŒ•           | ğŸŸ¢                    |                      |
| teams_list                              | ğŸŒ•           | ğŸŸ¢                    |                      |
| thread_files_policies_create            | ğŸŒ•           | ğŸŒ•                    |                      |
| threads_retrieve                        | ğŸŒ•           | ğŸŸ¢                    |                      |
| threads_list                            | ğŸŒ•           | ğŸŸ¢                    |                      |
| threads_create                          | ğŸŒ•           | ğŸŒ•                    |                      |
| threads_messages_list                   | ğŸŒ•           | ğŸŸ¢                    |                      |
| user_messages_create                    | ğŸŒ•           | ğŸŒ•                    |                      |
| threads_messages_retrieve               | ğŸŒ•           | ğŸŸ¢                    |                      |
| user_threads_retrieve                   | ğŸŒ•           | ğŸŒ•                    |                      |
| user_threads_update                     | ğŸŒ•           | ğŸŒ•                    |                      |
| threads_mark_read_update                | ğŸŒ•           | ğŸŒ•                    |                      |
| user_transactions_list_2                | ğŸŒ•           | ğŸŒ•                    |                      |
| transactions_list                       | ğŸŒ•           | ğŸŸ¢                    |                      |
| transactions_retrieve                   | ğŸŒ•           | ğŸŸ¢                    |                      |
| transactions_update                     | ğŸŒ•           | ğŸŒ•                    |                      |
| transactions_images_list                | ğŸŒ•           | ğŸŸ¢                    |                      |
| transfers_list                          | ğŸŒ•           | ğŸŸ¢                    |                      |
| transfers_create                        | ğŸŒ•           | ğŸŒ•                    |                      |
| transfers_scheduled_list                | ğŸŒ•           | ğŸŸ¢                    |                      |
| transfers_scheduled_create              | ğŸŒ•           | ğŸŒ•                    |                      |
| transfers_scheduled_update              | ğŸŒ•           | ğŸŒ•                    |                      |
| transfers_scheduled_destroy             | ğŸŒ•           | ğŸŒ•                    |                      |
| users_list                              | ğŸŒ•           | ğŸŸ¢                    |                      |
| users_retrieve                          | ğŸŒ•           | ğŸŸ¢                    |                      |
| users_update                            | ğŸŒ•           | ğŸŒ•                    |                      |
| users_enrollment_code_create            | ğŸŒ•           | ğŸŒ•                    |                      |
| users_enrollment_complete_create        | ğŸŒ•           | ğŸŒ•                    |                      |
| users_estatements_create                | ğŸŒ•           | ğŸŒ•                    |                      |
| users_estatements_destroy               | ğŸŒ•           | ğŸŒ•                    |                      |
| wire_recipients_list                    | ğŸŒ•           | ğŸŸ¢                    |                      |
| wire_recipients_create                  | ğŸŒ•           | ğŸŒ•                    |                      |
| wire_recipients_retrieve                | ğŸŒ•           | ğŸŸ¢                    |                      |
| wire_recipients_update                  | ğŸŒ•           | ğŸŒ•                    |                      |
| wire_recipients_partial_update          | ğŸŒ•           | ğŸŒ•                    |                      |
| wire_recipients_destroy                 | ğŸŒ•           | ğŸŒ•                    |                      |
| wires_fedwire_templates_create          | ğŸŒ•           | ğŸŒ•                    |                      |
